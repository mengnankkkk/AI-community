# Web界面使用指南

本指南详细介绍AI虚拟播客工作室的Web界面功能和使用方法，帮助评委和用户快速上手。

---

## 📱 界面概览

系统提供两个主要的Web界面：

1. **播客生成界面** (`index.html`) - 单个播客创作和管理
2. **批量评估界面** (`batch_eval.html`) - 批量生成和质量评估

### 访问地址

启动服务后，访问以下地址：

```
主界面：http://localhost:8000/static/index.html
批量评估：http://localhost:8000/static/batch_eval.html
API文档：http://localhost:8000/docs
```

---

## 🎨 界面1：播客生成界面

### 功能模块

#### 1. Hero横幅区域

**显示内容：**
- 系统slogan和功能介绍
- 实时统计数据（已生成播客数、知识库文档数）
- 快速操作按钮

**操作：**
- 点击"开始创作"按钮滚动到表单区域
- 点击"同步知识库"检查知识库状态

#### 2. 播客配置表单

##### 2.1 基本信息

**必填字段：**

| 字段 | 说明 | 示例 | 备注 |
|-----|------|-----|------|
| 主题 | 播客讨论的核心话题 | "人工智能的未来发展" | 必填，建议15-30字 |
| 标题 | 播客标题 | "AI前沿对话" | 可选，留空则自动生成 |
| 目标时长 | 播客时长 | "5分钟" | 可选3/5/10/15/30/60分钟 |

**风格配置：**

| 字段 | 可选值 | 说明 |
|-----|--------|------|
| 讨论氛围 | 轻松幽默/严肃深度/激烈辩论/温暖治愈 | 影响对话风格和情感 |
| 语言风格 | 口语化/正式/学术/网络流行语 | 影响措辞和表达方式 |

##### 2.2 角色配置

**添加角色步骤：**

1. 点击"添加角色"按钮
2. 填写角色信息：
   - **姓名**：角色名称（如"李明"）
   - **人设**：角色身份和背景（如"资深AI研究员"）
   - **核心观点**：角色的主要立场
   - **音色**：从预设音色中选择或上传自定义音色
   - **语气**：平和/热情/专业/幽默等
   - **语言习惯**：（可选）特殊表达方式
   - **背景故事**：（可选）增强角色深度

3. 点击"保存角色"

**角色数量限制：**
- 最少：2个角色
- 最多：5个角色
- 推荐：2-3个角色（更自然的对话）

**音色选择：**

| 音色名称 | 类型 | 特点 | 推荐场景 |
|---------|------|------|---------|
| longwan | 男声 | 沉稳、成熟 | 专家、学者 |
| longyuan | 男声 | 年轻、活力 | 主持人、记者 |
| longxiaochun | 女声 | 温柔、亲切 | 教育、健康类 |
| longxiaoyuan | 女声 | 活泼、开朗 | 娱乐、时尚类 |
| longshui | 女声 | 知性、专业 | 商业、科技类 |

##### 2.3 知识库配置（可选）

**添加背景资料的方式：**

**方式1：直接输入文本**
```
在"背景资料"文本框中直接粘贴内容
支持长文本（建议不超过5000字）
```

**方式2：上传文件**
- 支持格式：TXT, MD, PDF, DOCX, JSON
- 点击"上传文件"按钮选择本地文件
- 系统自动解析并添加到知识库

**方式3：网页URL**
- 在"网页链接"输入框中输入URL
- 支持静态网页和动态JavaScript渲染页面
- 点击"添加链接"

**知识库管理：**
- 查看已添加的文档列表
- 删除不需要的文档
- 知识库文档数量显示在Hero区域

#### 3. 生成和进度跟踪

**提交生成：**

1. 填写完所有必填信息
2. 点击"生成播客"按钮
3. 系统显示任务ID和进度条

**进度显示：**

```
状态：等待中 → 生成剧本中 → 合成语音中 → 后处理中 → 完成
进度：0% → 25% → 75% → 90% → 100%
预计时间：实时更新
```

**进度条颜色：**
- 蓝色：进行中
- 绿色：已完成
- 红色：失败

#### 4. 结果展示

**播放器区域：**
- 音频播放器（支持播放、暂停、调整进度）
- 显示播客时长和当前播放时间
- 音量调节

**剧本预览：**
- 按时间轴显示对话内容
- 标注角色、情感、停顿时间
- 可折叠/展开每段对话

**操作按钮：**
- **下载音频**：下载MP3文件
- **下载剧本**：下载JSON格式剧本
- **重新生成**：使用相同配置重新生成
- **分享**：生成分享链接（如果启用）

#### 5. 质量评估

**自动评估：**
生成完成后自动运行质量评估，显示：

- **综合评分**：1-10分（加权总分）
- **内容质量**：主题相关性、逻辑连贯性
- **音频质量**：音质、响度平衡
- **改进建议**：针对性的优化建议

**评分标准：**
- 9-10分：专业级，可直接发布
- 7-8分：良好，建议微调
- 5-6分：合格，需优化
- <5分：不合格，建议重新生成

### 快捷操作

**键盘快捷键：**
- `Ctrl + Enter`：提交生成
- `Ctrl + S`：保存草稿（如果启用）
- `Space`：播放/暂停音频
- `Esc`：关闭弹窗

**右键菜单：**
- 在角色卡片上右键：快速编辑/复制/删除
- 在剧本区域右键：复制文本/导出片段

---

## 📊 界面2：批量评估界面

### 功能概览

批量评估界面专为评委和测试人员设计，支持：
- ✅ 批量上传测试场景
- ✅ 一键提交多个生成任务
- ✅ 实时监控所有任务进度
- ✅ 自动质量评估和统计
- ✅ 批量下载和导出报告

### 界面布局

```
┌─────────────────────────────────────────────────┐
│  顶部统计条：总任务/已完成/进行中/成功率         │
├──────────────┬──────────────────────────────────┤
│              │                                  │
│  左侧区域：  │  右侧区域：                      │
│  - 任务配置  │  - 任务列表                      │
│  - 上传文件  │  - 实时进度                      │
│  - 预设场景  │  - 评估结果                      │
│  - 评估配置  │  - 统计图表                      │
│              │                                  │
└──────────────┴──────────────────────────────────┘
```

### 使用流程

#### 步骤1：准备测试场景

**方式A：上传配置文件**

1. 切换到"上传文件"标签
2. 拖放或点击选择文件
3. 支持格式：

**JSON格式示例：**
```json
[
  {
    "topic": "人工智能的未来发展",
    "title": "AI前沿对话",
    "atmosphere": "serious_deep",
    "target_duration": "5分钟",
    "language_style": "formal",
    "num_characters": 2
  },
  {
    "topic": "健康生活方式",
    "target_duration": "5分钟",
    "num_characters": 2
  }
]
```

**CSV格式示例：**
```csv
topic,title,atmosphere,target_duration,language_style,num_characters
人工智能的未来发展,AI前沿对话,serious_deep,5分钟,formal,2
健康生活方式,,casual_light,5分钟,casual,2
```

4. 文件上传后显示预览
5. 确认无误后，任务自动添加到列表

**下载模板：**
- 点击"下载JSON模板"或"下载CSV模板"
- 在模板基础上编辑测试场景

**方式B：使用预设场景**

1. 切换到"预设场景"标签
2. 选择场景集合：
   - **演示场景**：3个基础测试场景
   - **科技类**：5个科技主题场景
   - **教育类**：5个教育主题场景
   - **商业类**：5个商业主题场景
   - **综合测试**：10个多样化场景
3. 点击"加载预设场景"

**方式C：手动输入**

1. 切换到"手动输入"标签
2. 填写主题、角色数量、时长
3. 点击"添加到任务列表"
4. 重复添加多个任务

#### 步骤2：配置评估选项

在"评估配置"卡片中：

- [x] **生成完成后自动评估**：推荐开启
- [x] **自动下载生成的音频**：批量保存结果
- [x] **生成详细评估报告**：包含每个任务的完整评分

#### 步骤3：开始批量生成

1. 确认任务列表中有待生成的任务
2. 点击"开始生成"按钮
3. 系统按顺序处理每个任务

**进度监控：**
- 顶部统计数据实时更新
- 任务卡片显示当前状态和进度
- 状态标签颜色：
  - 🟡 等待中（黄色）
  - 🔵 生成中（蓝色）
  - 🟢 已完成（绿色）
  - 🔴 失败（红色）

**控制按钮：**
- **暂停**：暂停当前批量生成（完成当前任务后暂停）
- **继续**：恢复生成
- **停止**：立即停止所有任务

#### 步骤4：查看和评估结果

**任务列表操作：**

每个任务卡片显示：
- 主题和配置信息
- 当前状态和进度
- 操作按钮：
  - 📥 **下载**：下载该任务的音频和剧本
  - ⭐ **评估**：单独评估该任务
  - 🗑️ **删除**：从列表中移除

**批量操作：**
- 点击"下载全部"：批量下载所有已完成的任务
- 点击"刷新"：更新任务状态

#### 步骤5：查看评估报告

**评估结果卡片显示：**

1. **总体统计：**
   - 平均综合评分
   - 平均音质评分
   - 成功率
   - 失败原因统计

2. **评分图表：**
   - 柱状图：每个任务的评分对比
   - 饼图：评分分布（优秀/良好/合格/不合格）
   - 折线图：评分趋势

3. **改进建议：**
   - 针对低分任务的优化建议
   - 常见问题总结

**导出报告：**

点击"导出报告"按钮，选择格式：
- **JSON**：完整数据，便于二次分析
- **CSV**：表格数据，适合Excel
- **PDF**：可视化报告，适合展示

### 高级功能

#### 1. 任务过滤和排序

在任务列表上方，可以：
- 按状态过滤（仅显示已完成/失败等）
- 按评分排序（从高到低/从低到高）
- 搜索任务（按主题关键词）

#### 2. 实时日志

点击任务卡片展开详情，查看：
- 生成日志（每个阶段的详细信息）
- 错误信息（如果失败）
- API调用记录

#### 3. 对比分析

选择多个已完成的任务，点击"对比分析"：
- 并排显示剧本内容
- 对比音频波形
- 评分维度对比雷达图

---

## 🎯 使用场景示例

### 场景1：快速单个测试（5分钟）

**目标：**快速生成一个播客，体验系统功能

**步骤：**
1. 访问主界面：http://localhost:8000/static/index.html
2. 填写主题："人工智能的未来"
3. 添加2个角色（使用默认配置）
4. 点击"生成播客"
5. 等待3-5分钟
6. 播放和下载结果

### 场景2：批量评估测试（30分钟）

**目标：**批量生成10个播客，评估系统性能

**步骤：**
1. 访问批量评估界面
2. 选择"预设场景" → "综合测试（10个）"
3. 点击"加载预设场景"
4. 确认"自动评估"和"自动下载"已勾选
5. 点击"开始生成"
6. 等待所有任务完成（约20-30分钟）
7. 查看评估报告
8. 导出评估报告（JSON/CSV）

### 场景3：自定义场景深度测试（60分钟）

**目标：**测试特定领域和风格的播客生成

**步骤：**
1. 准备知识库文档（PDF/TXT）
2. 访问主界面
3. 上传知识库文档
4. 配置复杂角色（含背景故事、语言习惯）
5. 选择特定氛围和风格
6. 生成播客
7. 详细评估剧本质量和音频效果
8. 调整配置重新生成对比

---

## 🔧 故障排查

### 常见问题

#### 1. 页面加载缓慢

**原因：**CDN资源加载慢

**解决：**
- 等待页面完全加载
- 或使用本地资源（修改HTML中的CDN链接）

#### 2. 生成失败

**可能原因：**
- API密钥未配置或错误
- 服务器未启动
- 网络连接问题

**排查步骤：**
1. 检查`.env`文件中的API密钥配置
2. 确认服务器正在运行（`http://localhost:8000/health`）
3. 查看浏览器控制台错误信息（F12）
4. 查看服务器日志

#### 3. 音频无法播放

**可能原因：**
- 文件格式不兼容
- 浏览器不支持

**解决：**
- 使用Chrome/Firefox/Edge等现代浏览器
- 下载MP3文件用本地播放器播放

#### 4. 批量任务卡住

**可能原因：**
- 服务器负载高
- TTS API限流

**解决：**
- 减少并发任务数量
- 等待当前任务完成
- 检查API配额

### 获取帮助

**在线文档：**
- API文档：http://localhost:8000/docs
- 技术报告：TECHNICAL_REPORT.md
- FAQ：README.md

**日志位置：**
- 服务器日志：控制台输出
- 任务日志：`data/tasks/` 目录
- 错误日志：`logs/error.log`（如果配置）

---

## 📱 移动端使用

Web界面采用响应式设计，支持移动端访问：

**推荐浏览器：**
- iOS：Safari 14+
- Android：Chrome 90+

**移动端限制：**
- 文件上传功能可能受限
- 批量操作建议使用PC端
- 音频自动播放可能被浏览器阻止

---

## 🎨 界面定制

### 主题切换

点击右上角设置按钮 → "深色模式"

### 修改配置

编辑以下文件可自定义界面：
- `src/frontend/style.css` - 样式和颜色
- `src/frontend/script.js` - 交互逻辑
- `src/frontend/index.html` - 结构和内容

---

## 📊 性能优化建议

### 加快生成速度

1. 使用较短的目标时长（3-5分钟）
2. 减少角色数量（2-3个）
3. 简化背景资料（<2000字）
4. 选择高性能TTS引擎（CosyVoice）

### 提高质量

1. 详细填写角色人设和背景故事
2. 提供充足的背景资料（RAG知识库）
3. 选择适合的讨论氛围和语言风格
4. 使用高质量音色（预设音色）

---

## 🏆 最佳实践

### 角色设计

✅ **推荐：**
- 角色人设清晰、有特色
- 核心观点明确且有差异
- 语言习惯符合角色身份

❌ **避免：**
- 角色人设模糊、同质化
- 观点过于极端或冲突
- 语言风格不匹配

### 主题选择

✅ **推荐：**
- 主题具体、有讨论空间
- 适合对话形式表达
- 有一定专业深度

❌ **避免：**
- 主题过于宽泛或狭窄
- 争议性过强的敏感话题
- 需要大量视觉辅助的内容

### 知识库配置

✅ **推荐：**
- 提供权威、准确的背景资料
- 资料与主题高度相关
- 合理的资料量（1000-5000字）

❌ **避免：**
- 资料来源不可靠
- 资料与主题无关
- 资料过少（<500字）或过多（>10000字）

---

**祝使用愉快！** 🎉

如有问题，请参考 `README.md` 或查看在线API文档。
